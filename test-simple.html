<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JMON Simple Test - No Dependencies</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2 { color: #2d3748; }
        .demo { margin: 20px 0; }
        .code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Monaco', 'Cascadia Code', monospace;
            font-size: 14px;
            margin: 10px 0;
            overflow-x: auto;
        }
        .highlight {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéµ JMON Simple - Zero Dependencies</h1>
        <div class="highlight">
            <strong>‚úÖ No Tone.js required!</strong><br>
            <strong>‚úÖ No ABC.js required!</strong><br>
            <strong>‚úÖ Pure Web Audio API + HTML</strong><br>
            <strong>‚úÖ Works in Observable without any imports</strong>
        </div>
    </div>

    <div class="container">
        <h2>1. Your Twinkle Composition</h2>
        <div class="code">jmonSimple.show(twinkle)</div>
        <div class="demo" id="demo1"></div>
    </div>

    <div class="container">
        <h2>2. Simple Player (Web Audio API)</h2>
        <div class="code">jmonSimple.play(twinkle)</div>
        <div class="demo" id="demo2"></div>
    </div>

    <div class="container">
        <h2>3. Array Format</h2>
        <div class="code">jmonSimple.display(simpleArray)</div>
        <div class="demo" id="demo3"></div>
    </div>

    <div class="container">
        <h2>4. Both Together</h2>
        <div class="code">jmonSimple.display(twinkle)</div>
        <div class="demo" id="demo4"></div>
    </div>

    <!-- Only load the simple JMON library - NO other dependencies -->
    <script src="./jmon-simple.js" type="module"></script>

    <script type="module">
        import { show, play, display } from './jmon-simple.js';

        // Your twinkle composition
        const twinkle = {
            metadata: {
                name: "Twinkle, Twinkle, Little Star"
            },
            tracks: {
                melody: [
                    { pitch: 60, duration: 1.0, time: 0.0 },
                    { pitch: 60, duration: 1.0, time: 1.0 },
                    { pitch: 67, duration: 1.0, time: 2.0 },
                    { pitch: 67, duration: 1.0, time: 3.0 },
                    { pitch: 69, duration: 1.0, time: 4.0 },
                    { pitch: 69, duration: 1.0, time: 5.0 },
                    { pitch: 67, duration: 2.0, time: 6.0 },
                    { pitch: 65, duration: 1.0, time: 8.0 },
                    { pitch: 65, duration: 1.0, time: 9.0 },
                    { pitch: 64, duration: 1.0, time: 10.0 },
                    { pitch: 64, duration: 1.0, time: 11.0 },
                    { pitch: 62, duration: 1.0, time: 12.0 },
                    { pitch: 62, duration: 1.0, time: 13.0 },
                    { pitch: 60, duration: 2.0, time: 14.0 }
                ]
            }
        };

        // Simple array format
        const simpleArray = [
            { pitch: 60, duration: 1.0, time: 0.0 },
            { pitch: 64, duration: 0.5, time: 1.0 },
            { pitch: 67, duration: 1.0, time: 1.5 },
            { pitch: 72, duration: 2.0, time: 2.5 }
        ];

        // Run demos when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üéµ Testing JMON Simple (zero dependencies)...');

            try {
                // Demo 1: Show ABC notation
                const demo1 = show(twinkle, { format: 'abc' });
                document.getElementById('demo1').appendChild(demo1);

                // Demo 2: Simple player
                const demo2 = play(twinkle);
                document.getElementById('demo2').appendChild(demo2);

                // Demo 3: Array format with both
                const demo3 = display(simpleArray);
                document.getElementById('demo3').appendChild(demo3);

                // Demo 4: Combined display
                const demo4 = display(twinkle);
                document.getElementById('demo4').appendChild(demo4);

                console.log('‚úÖ All demos loaded successfully!');
                console.log('üéÆ Try the play buttons - they use Web Audio API directly!');

            } catch (error) {
                console.error('‚ùå Demo error:', error);
                document.body.innerHTML += `
                    <div class="container" style="background: #fed7d7; border: 1px solid #feb2b2; color: #c53030;">
                        <h2>Error Loading Demos</h2>
                        <p><strong>Error:</strong> ${error.message}</p>
                    </div>
                `;
            }
        });

        // Make available for console testing
        window.jmonSimple = { show, play, display };
        window.testCompositions = { twinkle, simpleArray };
        
        console.log('üéÆ Test in console:');
        console.log('jmonSimple.show(testCompositions.twinkle)');
        console.log('jmonSimple.play(testCompositions.simpleArray)');
    </script>
</body>
</html>